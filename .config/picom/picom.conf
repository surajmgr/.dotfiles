################################################################################
#                                                                              #
#                            Picom Compositor Configuration                   #
#                              Black Professional Theme                        #
#                                                                              #
################################################################################

################################################################################
# BACKEND SETTINGS
################################################################################

# Rendering backend: 'glx', 'xrender', 'xr_glx_hybrid'
backend = "glx";

# Enable vertical synchronization
vsync = true;

# Use experimental backends
experimental-backends = true;

# Refresh rate (0 = auto-detect)
refresh-rate = 0;

################################################################################
# CORNER ROUNDING
################################################################################

# Corner radius for rounded corners
corner-radius = 8;

# Exclude specific windows from corner rounding
rounded-corners-exclude = [
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "class_g = 'Polybar'",
    "class_g = 'dwm'",
    "class_g = 'i3bar'",
    "class_g = 'rofi'"
];

# Round borders
round-borders = 1;

# Exclude from round borders
round-borders-exclude = [
    "class_g = 'Polybar'"
];

################################################################################
# SHADOWS
################################################################################

# Enable shadows
shadow = true;

# Shadow radius
shadow-radius = 12;

# Shadow opacity (0.0 - 1.0)
shadow-opacity = 0.5;

# Shadow offset
shadow-offset-x = -8;
shadow-offset-y = -8;

# Shadow colors (RGB values 0-1)
shadow-red = 0.0;
shadow-green = 0.0;
shadow-blue = 0.0;

# Exclude windows from shadows
shadow-exclude = [
    "class_g = 'Polybar'",
    "class_g = 'i3bar'",
    "class_g = 'rofi'",
    "class_g = 'Dunst'",
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "window_type = 'notification'",
    "_GTK_FRAME_EXTENTS@:c",
    "_NET_WM_STATE@:32a *= '_NET_WM_STATE_HIDDEN'"
];

################################################################################
# FADING
################################################################################

# Enable fading
fading = true;

# Fade-in speed (0.01 - 1.0)
fade-in-step = 0.04;

# Fade-out speed (0.01 - 1.0)
fade-out-step = 0.04;

# Fade delta (time between steps in ms)
fade-delta = 8;

# Exclude windows from fading
fade-exclude = [
    "class_g = 'slop'",   # Screenshot tool
    "class_g = 'rofi'"
];

# Disable fading for window open/close
no-fading-openclose = false;

# Disable fading for ARGB windows
no-fading-destroyed-argb = false;

################################################################################
# TRANSPARENCY & OPACITY
################################################################################

# Default inactive opacity (0.1 - 1.0)
inactive-opacity = 0.95;

# Default active opacity
active-opacity = 1.0;

# Frame opacity (window borders/titlebars)
frame-opacity = 0.8;

# Dim inactive windows
inactive-dim = 0.1;

# Don't let inactive opacity override window-specific opacity
inactive-opacity-override = false;

# Focus exclusions (windows that shouldn't be dimmed)
focus-exclude = [
    "class_g = 'Cairo-clock'",
    "class_g = 'Bar'",
    "class_g = 'slop'",
    "class_g = 'rofi'"
];

# Window-specific opacity rules
opacity-rule = [
    # Terminal applications - slightly transparent for style
    "95:class_g = 'Alacritty'",
    "95:class_g = 'kitty'",
    "90:class_g = 'URxvt'",
    "90:class_g = 'XTerm'",
    
    # Status bars - semi-transparent
    "90:class_g = 'Polybar'",
    "85:class_g = 'i3bar'",
    
    # Browsers - fully opaque for readability
    "90:class_g = 'firefox'",
    "100:class_g = 'chromium'",
    "100:class_g = 'Google-chrome'",
    
    # Development tools - mostly opaque
    "98:class_g = 'code-oss'",
    "98:class_g = 'Code'",
    "95:class_g = 'jetbrains-idea'",
    "95:class_g = 'jetbrains-pycharm'",
    
    # Media applications - fully opaque
    "100:class_g = 'mpv'",
    "100:class_g = 'vlc'",
    
    # Communication apps
    "95:class_g = 'discord'",
    "95:class_g = 'TelegramDesktop'",
    "95:class_g = 'Slack'",
    
    # System tools - fully opaque
    "100:class_g = 'Thunar'",
    "100:class_g = 'nautilus'",
    "100:class_g = 'Pcmanfm'",
    
    # Special cases
    "100:class_g = 'slop'",      # Screenshot selection
    "90:class_g = 'rofi'",       # App launcher
    "95:class_g = 'Dunst'"       # Notifications
];

# Menu opacity
menu-opacity = 0.9;

# Dropdown and popup menu opacity
dropdown_menu = { opacity = 0.9; };
popup_menu = { opacity = 0.9; };

################################################################################
# BACKGROUND BLUR
################################################################################

# Blur configuration
blur: {
    method = "dual_kawase";
    strength = 6;
    deviation = 1.0;
    kernel = "11x11gaussian";
    background = false;
    background-frame = false;
    background-fixed = false;
}

# Blur background exclusions
blur-background-exclude = [
    "window_type = 'dock'",
    "window_type = 'desktop'",
    "class_g = 'slop'",
    "class_g = 'Firefox' && argb",
    "_GTK_FRAME_EXTENTS@:c"
];

################################################################################
# ANIMATIONS & TRANSITIONS
################################################################################

# Animation settings
animations = true;

# Animation stiffness (higher = faster/snappier)
animation-stiffness = 200;

# Animation dampening (higher = less oscillation) 
animation-dampening = 25;

# Animation mass (higher = slower)
animation-mass = 1;

# Enable animation for window opening
animation-for-open-window = "zoom";

# Enable animation for window closing  
animation-for-unmap-window = "zoom";

# Animation duration in milliseconds
animation-duration = 250;

# Transition settings
transition-length = 150;
transition-pow-x = 0.3;
transition-pow-y = 0.3;
transition-pow-w = 0.3;
transition-pow-h = 0.3;
size-transition = true;

################################################################################
# PERFORMANCE & OPTIMIZATION
################################################################################

# Use damage information to limit redraws
use-damage = true;

# Unredirect windows when possible (performance)
unredir-if-possible = true;

# Delay before unredirecting (ms)
unredir-if-possible-delay = 0;

# Mark windows as focused
mark-wmwin-focused = true;
mark-ovredir-focused = true;

# Detect rounded corners
detect-rounded-corners = true;

# Detect client opacity
detect-client-opacity = true;

# Detect transient windows
detect-transient = true;

# Detect client leader
detect-client-leader = true;

################################################################################
# WINDOW TYPE SETTINGS
################################################################################

wintypes: {
    tooltip = { 
        fade = true; 
        shadow = false; 
        opacity = 0.85; 
        focus = true; 
        full-shadow = false; 
    };
    
    dock = { 
        shadow = false; 
        clip-shadow-above = true; 
    };
    
    dnd = { 
        shadow = false; 
    };
    
    popup_menu = { 
        opacity = 0.9; 
        shadow = true; 
        fade = true; 
    };
    
    dropdown_menu = { 
        opacity = 0.9; 
        shadow = true; 
        fade = true; 
    };
    
    above = { 
        shadow = true; 
    };
    
    splash = { 
        shadow = false; 
    };
    
    utility = { 
        focus = false; 
        shadow = false; 
        blur-background = false; 
    };
    
    notification = { 
        shadow = false; 
        fade = true; 
    };
    
    desktop = { 
        shadow = false; 
        blur-background = false; 
    };
    
    menu = { 
        focus = false; 
        opacity = 0.9; 
        shadow = true; 
    };
    
    dialog = { 
        shadow = true; 
    };
};

################################################################################
# LOGGING & DEBUG
################################################################################

# Log level: trace, debug, info, warn, error
log-level = "warn";

# Log to file (uncomment and specify path if needed)
# log-file = "/var/log/picom.log";

# Show all X errors
show-all-xerrors = false;

################################################################################
# GLX BACKEND SETTINGS
################################################################################

# Avoid rebinding pixmaps (performance)
glx-no-rebind-pixmap = true;

# Use stencil buffer (fixes some rendering issues)
glx-no-stencil = false;

# Copy unmodified regions (performance)
glx-copy-from-front = false;

################################################################################
# END OF CONFIGURATION
################################################################################
